Description: Set log_name for Swift services in default configs
Author: Ondřej Nový <novy@ondrej.org>
Forwarded: not-needed
Last-Update: 2016-07-05

Index: swift/etc/account-server.conf-sample
===================================================================
--- swift.orig/etc/account-server.conf-sample
+++ swift/etc/account-server.conf-sample
@@ -17,7 +17,7 @@ bind_port = 6202
 # max_clients = 1024
 #
 # You can specify default log routing here if you want:
-# log_name = swift
+log_name = swift-account
 # log_facility = LOG_LOCAL0
 # log_level = INFO
 # log_address = /dev/log
@@ -70,7 +70,7 @@ pipeline = healthcheck recon account-ser
 [app:account-server]
 use = egg:swift#account
 # You can override the default log routing for this app here:
-# set log_name = account-server
+set log_name = swift-account-server
 # set log_facility = LOG_LOCAL0
 # set log_level = INFO
 # set log_requests = true
@@ -110,7 +110,7 @@ use = egg:swift#recon
 
 [account-replicator]
 # You can override the default log routing for this app here (don't use set!):
-# log_name = account-replicator
+log_name = swift-account-replicator
 # log_facility = LOG_LOCAL0
 # log_level = INFO
 # log_address = /dev/log
@@ -166,7 +166,7 @@ use = egg:swift#recon
 
 [account-auditor]
 # You can override the default log routing for this app here (don't use set!):
-# log_name = account-auditor
+log_name = swift-account-auditor
 # log_facility = LOG_LOCAL0
 # log_level = INFO
 # log_address = /dev/log
@@ -191,7 +191,7 @@ use = egg:swift#recon
 
 [account-reaper]
 # You can override the default log routing for this app here (don't use set!):
-# log_name = account-reaper
+log_name = swift-account-reaper
 # log_facility = LOG_LOCAL0
 # log_level = INFO
 # log_address = /dev/log
Index: swift/etc/container-reconciler.conf-sample
===================================================================
--- swift.orig/etc/container-reconciler.conf-sample
+++ swift/etc/container-reconciler.conf-sample
@@ -2,7 +2,7 @@
 # swift_dir = /etc/swift
 # user = swift
 # You can specify default log routing here if you want:
-# log_name = swift
+log_name = swift-container-reconciler
 # log_facility = LOG_LOCAL0
 # log_level = INFO
 # log_address = /dev/log
Index: swift/etc/container-server.conf-sample
===================================================================
--- swift.orig/etc/container-server.conf-sample
+++ swift/etc/container-server.conf-sample
@@ -23,7 +23,7 @@ bind_port = 6201
 # allowed_sync_hosts = 127.0.0.1
 #
 # You can specify default log routing here if you want:
-# log_name = swift
+log_name = swift-container
 # log_facility = LOG_LOCAL0
 # log_level = INFO
 # log_address = /dev/log
@@ -76,7 +76,7 @@ pipeline = healthcheck recon container-s
 [app:container-server]
 use = egg:swift#container
 # You can override the default log routing for this app here:
-# set log_name = container-server
+set log_name = swift-container-server
 # set log_facility = LOG_LOCAL0
 # set log_level = INFO
 # set log_requests = true
@@ -119,7 +119,7 @@ use = egg:swift#recon
 
 [container-replicator]
 # You can override the default log routing for this app here (don't use set!):
-# log_name = container-replicator
+log_name = swift-container-replicator
 # log_facility = LOG_LOCAL0
 # log_level = INFO
 # log_address = /dev/log
@@ -175,7 +175,7 @@ use = egg:swift#recon
 
 [container-updater]
 # You can override the default log routing for this app here (don't use set!):
-# log_name = container-updater
+log_name = swift-container-updater
 # log_facility = LOG_LOCAL0
 # log_level = INFO
 # log_address = /dev/log
@@ -211,7 +211,7 @@ use = egg:swift#recon
 
 [container-auditor]
 # You can override the default log routing for this app here (don't use set!):
-# log_name = container-auditor
+log_name = swift-container-auditor
 # log_facility = LOG_LOCAL0
 # log_level = INFO
 # log_address = /dev/log
@@ -236,7 +236,7 @@ use = egg:swift#recon
 
 [container-sync]
 # You can override the default log routing for this app here (don't use set!):
-# log_name = container-sync
+log_name = swift-container-sync
 # log_facility = LOG_LOCAL0
 # log_level = INFO
 # log_address = /dev/log
Index: swift/etc/drive-audit.conf-sample
===================================================================
--- swift.orig/etc/drive-audit.conf-sample
+++ swift/etc/drive-audit.conf-sample
@@ -5,7 +5,7 @@
 # device_dir = /srv/node
 #
 # You can specify default log routing here if you want:
-# log_name = drive-audit
+log_name = swift-drive-audit
 # log_facility = LOG_LOCAL0
 # log_level = INFO
 # log_address = /dev/log
Index: swift/etc/internal-client.conf-sample
===================================================================
--- swift.orig/etc/internal-client.conf-sample
+++ swift/etc/internal-client.conf-sample
@@ -2,7 +2,7 @@
 # swift_dir = /etc/swift
 # user = swift
 # You can specify default log routing here if you want:
-# log_name = swift
+log_name = swift-internal-client
 # log_facility = LOG_LOCAL0
 # log_level = INFO
 # log_address = /dev/log
Index: swift/etc/object-expirer.conf-sample
===================================================================
--- swift.orig/etc/object-expirer.conf-sample
+++ swift/etc/object-expirer.conf-sample
@@ -2,7 +2,7 @@
 # swift_dir = /etc/swift
 # user = swift
 # You can specify default log routing here if you want:
-# log_name = swift
+log_name = swift-object-expirer
 # log_facility = LOG_LOCAL0
 # log_level = INFO
 # log_address = /dev/log
Index: swift/etc/object-server.conf-sample
===================================================================
--- swift.orig/etc/object-server.conf-sample
+++ swift/etc/object-server.conf-sample
@@ -25,7 +25,7 @@ bind_port = 6200
 # max_clients = 1024
 #
 # You can specify default log routing here if you want:
-# log_name = swift
+log_name = swift-object
 # log_facility = LOG_LOCAL0
 # log_level = INFO
 # log_address = /dev/log
@@ -93,7 +93,7 @@ pipeline = healthcheck recon object-serv
 [app:object-server]
 use = egg:swift#object
 # You can override the default log routing for this app here:
-# set log_name = object-server
+set log_name = swift-object-server
 # set log_facility = LOG_LOCAL0
 # set log_level = INFO
 # set log_requests = true
@@ -213,7 +213,7 @@ use = egg:swift#recon
 
 [object-replicator]
 # You can override the default log routing for this app here (don't use set!):
-# log_name = object-replicator
+log_name = swift-object-replicator
 # log_facility = LOG_LOCAL0
 # log_level = INFO
 # log_address = /dev/log
@@ -303,7 +303,7 @@ use = egg:swift#recon
 # in the [object-replicator] section, however these settings apply to the EC
 # reconstructor
 #
-# log_name = object-reconstructor
+log_name = swift-object-reconstructor
 # log_facility = LOG_LOCAL0
 # log_level = INFO
 # log_address = /dev/log
@@ -356,7 +356,7 @@ use = egg:swift#recon
 
 [object-updater]
 # You can override the default log routing for this app here (don't use set!):
-# log_name = object-updater
+log_name = swift-object-updater
 # log_facility = LOG_LOCAL0
 # log_level = INFO
 # log_address = /dev/log
@@ -394,7 +394,7 @@ use = egg:swift#recon
 
 [object-auditor]
 # You can override the default log routing for this app here (don't use set!):
-# log_name = object-auditor
+log_name = swift-object-auditor
 # log_facility = LOG_LOCAL0
 # log_level = INFO
 # log_address = /dev/log
Index: swift/etc/proxy-server.conf-sample
===================================================================
--- swift.orig/etc/proxy-server.conf-sample
+++ swift/etc/proxy-server.conf-sample
@@ -39,7 +39,7 @@ bind_port = 8080
 # expiring_objects_account_name = expiring_objects
 #
 # You can specify default log routing here if you want:
-# log_name = swift
+log_name = swift-proxy
 # log_facility = LOG_LOCAL0
 # log_level = INFO
 # log_headers = false
@@ -104,7 +104,7 @@ pipeline = catch_errors gatekeeper healt
 [app:proxy-server]
 use = egg:swift#proxy
 # You can override the default log routing for this app here:
-# set log_name = proxy-server
+set log_name = swift-proxy-server
 # set log_facility = LOG_LOCAL0
 # set log_level = INFO
 # set log_address = /dev/log
@@ -283,7 +283,7 @@ use = egg:swift#proxy
 [filter:tempauth]
 use = egg:swift#tempauth
 # You can override the default log routing for this filter here:
-# set log_name = tempauth
+set log_name = swift-proxy-tempauth
 # set log_facility = LOG_LOCAL0
 # set log_level = INFO
 # set log_headers = false
@@ -454,7 +454,7 @@ use = egg:swift#healthcheck
 [filter:cache]
 use = egg:swift#memcache
 # You can override the default log routing for this filter here:
-# set log_name = cache
+set log_name = swift-proxy-cache
 # set log_facility = LOG_LOCAL0
 # set log_level = INFO
 # set log_headers = false
@@ -487,7 +487,7 @@ use = egg:swift#memcache
 [filter:ratelimit]
 use = egg:swift#ratelimit
 # You can override the default log routing for this filter here:
-# set log_name = ratelimit
+set log_name = swift-proxy-ratelimit
 # set log_facility = LOG_LOCAL0
 # set log_level = INFO
 # set log_headers = false
@@ -534,7 +534,7 @@ use = egg:swift#ratelimit
 [filter:domain_remap]
 use = egg:swift#domain_remap
 # You can override the default log routing for this filter here:
-# set log_name = domain_remap
+set log_name = swift-proxy-domain_remap
 # set log_facility = LOG_LOCAL0
 # set log_level = INFO
 # set log_headers = false
@@ -569,7 +569,7 @@ use = egg:swift#domain_remap
 [filter:catch_errors]
 use = egg:swift#catch_errors
 # You can override the default log routing for this filter here:
-# set log_name = catch_errors
+set log_name = swift-proxy-catch_errors
 # set log_facility = LOG_LOCAL0
 # set log_level = INFO
 # set log_headers = false
@@ -579,7 +579,7 @@ use = egg:swift#catch_errors
 # Note: this middleware requires python-dnspython
 use = egg:swift#cname_lookup
 # You can override the default log routing for this filter here:
-# set log_name = cname_lookup
+set log_name = swift-proxy-cname_lookup
 # set log_facility = LOG_LOCAL0
 # set log_level = INFO
 # set log_headers = false
@@ -601,7 +601,7 @@ use = egg:swift#cname_lookup
 [filter:staticweb]
 use = egg:swift#staticweb
 # You can override the default log routing for this filter here:
-# set log_name = staticweb
+set log_name = swift-proxy-staticweb
 # set log_facility = LOG_LOCAL0
 # set log_level = INFO
 # set log_headers = false
@@ -669,7 +669,7 @@ use = egg:swift#list_endpoints
 [filter:proxy-logging]
 use = egg:swift#proxy_logging
 # If not set, logging directives from [DEFAULT] without "access_" will be used
-# access_log_name = swift
+access_log_name = swift-proxy-proxy-logging
 # access_log_facility = LOG_LOCAL0
 # access_log_level = INFO
 # access_log_address = /dev/log
@@ -808,7 +808,7 @@ use = egg:swift#gatekeeper
 # shunt_inbound_x_timestamp = true
 #
 # You can override the default log routing for this filter here:
-# set log_name = gatekeeper
+set log_name = swift-proxy-gatekeeper
 # set log_facility = LOG_LOCAL0
 # set log_level = INFO
 # set log_headers = false
Index: swift/swift/container/sync.py
===================================================================
--- swift.orig/swift/container/sync.py
+++ swift/swift/container/sync.py
@@ -51,7 +51,7 @@ ic_conf_body = """
 # swift_dir = /etc/swift
 # user = swift
 # You can specify default log routing here if you want:
-# log_name = swift
+log_name = swift-internal-client
 # log_facility = LOG_LOCAL0
 # log_level = INFO
 # log_address = /dev/log
